<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no">
    <meta name="description" content="">
    <meta name="Copyright" content="宜联科技" />
    <meta name="author" content="">

    <link rel="shortcut icon" href="../images/favicon/favicon.png" type="image/x-icon">
    <link rel="icon" href="../images/favicon/favicon.png" type="image/x-icon">

    <title>遂宁市安居区人民法院</title>

    <!--Library Styles-->
    <link href="../css/normalize.css" rel="stylesheet" type="text/css" />
    <link href="../css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="css/shixin.css" rel="stylesheet" />

    <!--<link href="css/bootstrap.min.css" rel="stylesheet" />
    <link href="css/normalize.css" rel="stylesheet" />
    <link href="css/shixin.css" rel="stylesheet" />-->

    <style>
        table tr {
            border: 1px solid #ffffff;
            /*background-color: #D5D5D5*/
        }

            table tr td {
                border: 1px solid #ffffff;
                padding: 1px 5px;
            }

        .first_tr_td {
            width: 18%;
        }

        .other_td {
            text-align: left;
            color: white;
            font-size: 14px;
            font-weight: 100;
        }

            .other_td strong {
                font-size: 14px;
                margin-right: 8px;
            }

        .first_tr_td img {
            width: 100%;
            padding: 5% 4%;
        }
        /*tr:nth-child(odd){background-color:#ffffff; #2E7BC6}
        tr:nth-child(even){background-color:#F0F0F0;}*/
    </style>
</head>
<body>
    <div class="headbox">
        <div class="header">
            <div class="fyname row text-left vertical-middle-sm">
                <div class="col-sm-8 text-left">
                    <h1>遂宁市安居区人民法院</h1>
                    <p class="lead">诉讼服务中心——失信被执行人查询</p>
                </div>
                <div class="bp col-sm-8"></div>
            </div>
        </div>
    </div>
    <div class="mainpage">
        <div class="wrapper" style="margin:0 50px">
            <div class="shixintab gallery">
                <div class="title"><h3>失信被执行人查询</h3></div>
                <div class="title">
                    <h6>(查询提示：在输入框输入姓名、身份证号、案号可快速定位，点击标题可重新排序。)</h6>
                </div>



                <div id="sxrTable">
                    <!--
            <table class="display dTable" id="sxrTable" cellspacing="0" style="width:100%;border-collapse: collapse">
                <tr>
                    <td rowspan="6" class="first_tr_td">
                        <img style="width:100%;" src="../Images/2017-05/20170515095231704.jpg" />
                    </td>
                    <td class="other_td">
                        <strong style="">执行案号:</strong>
                        尽快发货尽快回复空间十分健康和精神凤凰健康空间十分健康和房价开始反抗精神凤凰健康
                    </td>
                </tr>
                <tr>
                    <td class="other_td"><strong>被执行人:</strong>沪电股份</td>
                </tr>
                <tr>
                    <td class="other_td"><strong>证件号码:</strong>513022199308110233</td>
                </tr>
                <tr>
                    <td class="other_td"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;义务:</strong>给付</td>
                </tr>
                <tr>
                    <td class="other_td"><strong>履行情况:</strong>全部未履行</td>
                </tr>
                <tr>
                    <td class="other_td"><strong>具体情形:</strong>反抗精神凤凰健康尽快发货尽快回复空间十分健康和房价开始反抗精神凤凰健康</td>
                </tr>
            </table>-->
                </div>

                <div class="title clearfix" style="background-color:#F0F0F0;padding:5px 20px;">
                    <span style="display:block;float:left;color:black;margin-top: 3px">模糊查询：</span>
                    <input type="text" class="form-control" placeholder="姓名/案号" id="searchText" style="width:200px; float:left;height:30px">
                    <button type="button" class="btn btn-default btn-sm" style="display:block;float:left;margin-left:5px;" id="searchBtn">查 询</button>
                    <span style="display:block;float:right;color:black;margin-top: 3px;margin-left:10px">共<span id="total">18</span>页</span>
                    <div class="btn-group clearfix" style="float:right;margin-top:2px" id="btn">
                        <!--<button type="button" class="btn btn-default btn-sm">第一页</button>
                <button type="button" class="btn btn-default btn-sm">上一页</button>
                <button type="button" class="btn btn-default btn-sm"> 1</button>
                <button type="button" class="btn btn-default btn-sm"> 2</button>
                <button type="button" class="btn btn-default btn-sm"> 3</button>
                <button type="button" class="btn btn-default btn-sm"> 3</button>
                <button type="button" class="btn btn-default btn-sm"> 3</button>
                <button type="button" class="btn btn-default btn-sm">下一页</button>
                <button type="button" class="btn btn-default btn-sm">最后一页</button>-->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer divbgtransparent_white7"><div class="copyrights"></div></div>
</body>
</html>
<script type="text/javascript" src="../js/jquery.min.js"></script>

<script type="text/javascript">
    $(function () {
        domin.loadData(true);
        domin.search();
    });

    var domin = (function (obj) { return obj; }(new function () {
        var VirtualDirectory = "/sn_ajqfy/Manage";

        var params = {
            url: VirtualDirectory + '/Admin/Sxr/ListBySxr',
            page: 1,
            rows: 4,
            sort: 'ID',
            searchText:'',
        }

        //加载数据
        function loadData(IsCalculate) {
            $('#sxrTable').html('');
            $.ajax({
                url: params.url,
                data: params,
                type: 'POST',
                dataType: 'json',
                async: true,
                success: function (r) {
                    if (r.rows.length > 0) {
                        var html = [];
                        $(r.rows).each(function () {
                            var iExecuteState = this.iExecuteState;
                            var iExecuteStateName = "";
                            switch (iExecuteState) {
                                case 1: iExecuteStateName = "部分未履行"; break;
                                case 2: iExecuteStateName = "全部未履行"; break;
                            }
                            var bSexName = this.bSex == true ? "男" : "女";
                            html.push('<table class="display dTable" cellspacing="0" style="width:100%;margin-top:-10px; collapse;margin-bottom:20px">');
                            html.push('<tr>');
                            if (this.UserPic)
                                html.push('<td rowspan="6" class="first_tr_td"><img src="' + VirtualDirectory + this.UserPic + '" /></td>');
                            else
                                html.push('<td rowspan="6" class="first_tr_td"><img src="' + VirtualDirectory +'/Images/nopic.jpg'+'" /></td>');
                            html.push('<td class="other_td"><strong style="">执行案号:</strong>' + this.CaseNum + '</td>');
                            html.push('</tr>');
                            html.push('<tr><td class="other_td"><strong>被执行人:</strong>' + this.RealName +"("+bSexName+','+this.iAges+')'+'</td></tr>');
                            html.push('<tr><td class="other_td"><strong>证件号码:</strong>' + this.IDCard + '</td></tr>');
                            html.push('<tr><td class="other_td"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;义务:</strong>' + this.CaseBiaodi+ '</td></tr>');
                            html.push('<tr><td class="other_td"><strong>履行情况:</strong>' + iExecuteStateName + '</td></tr>');
                            html.push('<tr><td class="other_td"><strong>具体情形:</strong>' + this.sCase + '</td></tr>');
                            html.push('</table>');
                        });
                        $('#sxrTable').append(html.join(''));
                        $('#sxrTable table').eq(0).css({ "margin-top": "-3px" });
                        $('#sxrTable table').eq(r.rows.length-1).css({ "margin-bottom": "0px" });
                    }
                    //计算分页
                    if (IsCalculate)
                        Calculate(r.total);

                },
                // jqXHR 是经过jQuery封装的XMLHttpRequest对象
                // textStatus 可能为null、 'timeout（超时）'、 'error（错误）'、 'abort(中止)'和'parsererror（解析错误)'等
                // errorMsg 是错误信息字符串(响应状态的文本描述部分，例如'Not Found'或'Internal Server Error')
                error: function (jqXHR, textStatus, errorMsg) {
                    switch (jqXHR.status) {
                        case 404: alert('链接地址错误!'); break;
                        case 500: alert('服务器内部错误!'); break;
                        default: alert(jqXHR.status + ":" + jqXHR.statusText);
                    }
                }
            });
        }

        //按钮的显示计算
        function Calculate(total) {
            $('#btn').html('');
            var yushu = total % (params.rows);
            var num = parseInt(total / params.rows);
            if (yushu > 0) num = num + 1;
            $('#total').text(num);//计算页数
            var btnHtml = [];
            btnHtml.push('<button type="button" class="btn btn-default btn-sm firstPage">第一页</button>');
            btnHtml.push('<button type="button" class="btn btn-default btn-sm prePage disabled">上一页</button>');
            for (var i = 1; i <= num; i++) {
                if (i >= 7) {
                    btnHtml.push('<button type="button" class="btn btn-default btn-sm">...</button>');
                    break;
                }
                else
                    if (i == 1)
                        btnHtml.push('<button type="button" class="btn btn-primary btn-sm mybtn">' + i + '</button>');
                    else
                        btnHtml.push('<button type="button" class="btn btn-default btn-sm mybtn">' + i + '</button>');
            }
            if (num == 1) {
                btnHtml.push('<button type="button" class="btn btn-default btn-sm nextPage disabled">下一页</button>');
            }
            else
                btnHtml.push('<button type="button" class="btn btn-default btn-sm nextPage">下一页</button>');
            btnHtml.push('<button type="button" class="btn btn-default btn-sm LastPage">最后一页</button>');
            $('#btn').append(btnHtml.join(''));

            //如果查询没有结果
            if (total == 0) {
                $('.btn').addClass("disabled");
                $('#searchBtn').removeClass("disabled");
            }


            //绑定事件
            $('.firstPage').on("click", function () {
                if (!$(this).hasClass("disabled")) {
                    $('.btn-primary').removeClass('btn-primary').addClass('btn-default');
                    if (num >= 1) {
                        $('.prePage').addClass("disabled");
                        $('.nextPage').removeClass("disabled");
                        $('.prePage').next().addClass("btn-primary");
                        if (num > 6) {
                            $('.nextPage').prev().text("...");
                        }
                        params.page = 1;
                        loadData(false);
                    }
                }
            });

            //上一页
            $('.prePage').on("click", function () {
                if (!$(this).hasClass("disabled")) {
                    //如果不能点击将不产生动作
                    $('.nextPage').removeClass('disabled');
                    var selected = parseInt($('.btn-primary').text());
                    var thisBtn = $('.btn-primary');
                    if (selected <7) {
                        $('.btn-primary').removeClass("btn-primary").addClass("btn-default");
                        $(thisBtn).prev().removeClass("btn-default").addClass("btn-primary");
                        if (selected == 2)
                            $('.prePage').addClass('disabled');
                    }
                    else {
                        if (selected == 7) {
                            $('.btn-primary').removeClass("btn-primary").addClass("btn-default");
                            $(thisBtn).prev().removeClass("btn-default").addClass("btn-primary");
                            $(thisBtn).text("....");
                        }
                        else
                            $(thisBtn).text(selected - 1);

                    }

                    //加载数据
                    params.page = selected - 1;
                    loadData(false);
                }
            });


            //下一页
            $('.nextPage').on("click", function () {
                if (!$(this).hasClass("disabled")) {
                    //如果不能点击将不产生动作
                    if (num > 1) $('.prePage').removeClass('disabled');
                    var selected = parseInt($('.btn-primary').text());
                    if (num == selected + 1) $(this).addClass('disabled');
                    var thisbtn = $('.btn-primary');
                    if (selected < 6) {
                        $('.btn-primary').next().removeClass("btn-default").addClass("btn-primary");
                        $(thisbtn).removeClass("btn-primary").addClass("btn-default");
                    }
                    else {
                        if (selected < num) {
                            if (selected == 6) {
                                $('.btn-primary').next().removeClass("btn-default").addClass("btn-primary");
                                $(thisbtn).removeClass("btn-primary").addClass("btn-default");
                                $(thisbtn).next().text(selected + 1);
                            }
                            else
                                $(thisbtn).text(selected + 1);
                            if (selected == num - 1)
                                $('.nextPage').addClass('disabled')
                        }
                    }

                    //加载数据
                    params.page = selected + 1;
                    loadData(false);
                }
            });

            //最后一页
            $('.LastPage').on("click", function () {
                if (!$(this).hasClass("disabled")) {
                    if (num != 1) $('.prePage').removeClass('disabled');
                    $('.btn-primary').removeClass('btn-primary').addClass('btn-default');
                    $('.nextPage').addClass('disabled');
                    $('.nextPage').prev().text(num);
                    $('.nextPage').prev().addClass('btn-primary');;
                    params.page = num;
                    loadData(false);
                }
            });

             //按钮点击
            $('.mybtn').on("click", function () {
                var select = $(this).text();
                var preSelect =parseInt($('.btn-primary').text());
                if (!isNaN(Number(select))) {
                    if (select == num) $('.nextPage').addClass("disabled");
                    if (select < num) $('.nextPage').removeClass("disabled");
                    if (preSelect >= 7) {
                        $('.btn-primary').text("...");
                        $('.btn-primary').removeClass("btn-primary").addClass("btn-default");
                    }
                    $('.mybtn').removeClass("btn-primary").addClass("btn-default");
                    $(this).removeClass("btn-default").addClass("btn-primary");
                    if (select == 1)
                        $('.prePage').addClass("disabled");
                    else $('.prePage').removeClass("disabled");
                    if (select == num) $('.nextPage').addClass("disabled");
                    params.page = select;
                    loadData(false);
                }
            });
        }

        //模糊查询
        function search() {
            $('#searchBtn').on("click", function () {
                var searchText = $("#searchText").val();
                params.searchText = searchText;
                params.page = 1;
                loadData(true)
            })
        }

        return {
            loadData: loadData,
            search: search
        }

    }));
</script>